"use strict";

const input = `ewnwnwsenwnwnwwnweswnwnenwnwesenwwnww
wswwswwnwwswswswswnewswwwewsew
seseeseswwneseseseseseenenesewsesesew
nwwnwnenenwneseseenewnenenenenenwnenenene
enwnenwwnwwwswswseewnwenwwnw
nwsenwsenwewnwewwwwnwnenwwnwswwe
seseseeseeseneseseseeseseesesw
nwsweswsenwnenesweseenenwswnenwenwwe
nwswnwnwneenwnenwnwnwnwnwwnwswswnwwenwnw
nwwnwnwnwenwnwnwnwwnwnwnwswwwnwnwe
neswseseseeewnwsenwswsweseswwswsesw
swnenenwneeneeeeeneeneee
wesewseseseseswnesewseseseenwsenenwse
eneeseswswswswnwsewseenwnwswseswswnwsw
seswsweswneeswswnewwswnwnwnewnesesesese
enenweeneeeeewneeneswese
eneeneeeneeneneenwseeswnenenewsee
enwnwenwsenwnwnwnwnwnwnwwnwnwswnwnwnwnwsw
wwwwnwwwnwwsewwnwnwwnwwsenenww
eeneswneeneeeeesesewenwswnwenenwsw
seneswsewsewneneeeneeeeswwnwee
nwwwswwsewswewwwwswnewswwwwsew
senwseseseseswswseseseswseesesesese
wwswseswwswswswseswenwswwnenwswswswsw
seseneswswseswswneswneseswwswwswwneswwsw
nwswwswswseswswswwnwsweeswnwsweswsw
seseesesesenwseeseseseseseswse
neenesweswnwnwwwnwsenewnwnewwswwnw
senwseswseseseswnewsesweswswsweswse
wwnwwnwswwnwwwwwnwne
sesesesenenewsesesweseseswsewsewse
seswneseseswsewnenweswseswsenweswneswsesw
eneswnewneneneeneneneeneneneeneene
weseswwwwnwnwwwseswwneeswwww
seeeenwseenwnwswseeeseseeseeeee
sesesenwseswneseeenwseseseswswwswesenw
nwnwenwnwnwwswnwnwnwnwwenwsenwnwnww
nwnwnwneneswwnenwnenenwnwsenwnenwnwnenwne
senewnwneenwwswwnwnwneenenwsw
neneneneneenenwnenenesenenwnesenwswnene
neswswsweswswswswnenwswwswswewneswsw
sesesesesesenwswswsesesesesewswnese
eneseeseeeseeswsesese
wwseseseswswseseseeswwseswnewseenesw
eeeeeeeeswnewwenweewwnwswse
nwwswenwnwswenwnwnwwnwewnwnwwnwwnw
nwnwsewnwwnwenwnwnwnwwnwswnwnwnwnww
nwnwwswswnwneeneswnwnwenwenwnwnwnwwnw
neswneneneneneneenenesw
newenwswseeweseesweweseneewnesee
enwwswwwnwwnwseswwwwwnenwnenesw
seswnwseseneneseeswswswnewwswswew
wnwsewwnwwenwseeeww
swswswswswnwswswswnesenwswsesweswswwswsw
wneweswswswswswswswwwswwsewswnwsw
swwswswneswswswwswwneswswswswswswswesw
seeseseeeenwenweeenwsenweswswnwse
swswswswswswswswwneswneseswwswwsww
neeneneseneewsenenenenewnenenenenene
nwwnwseeneswswnwneswneeswseenwnwnesww
wneswseswswnwswwswwswwswwnewenese
seewesesesesewseseseeseseseneseesese
sesenwnwswneswswseswwsewneswneseenenww
swswewseseswnwswseseseswsewswnenwsesese
swwswswswswswwnewswewwswswwswswe
wsesesewneneeswsweeneswwnwswsw
neswswswswseswseseswswseswswneswsw
enwseewsweseeeeeeesesweneseenw
wewnewwwwwwnewwwswwwwsww
eswnwwswsenwwwenwswwswwsenenesw
ewnwnwswsenwnwnwnwwwnwenwwnwnwnwnw
wnwenenwenwnwsenwnwswnenwnewnenenese
sewwenwwwnwnwwwnwnesenwnwnw
eeeeeeeneeeeweeeseesw
wswsewnenwwwnwnwnwnwnwnwnwneswnwww
swenweeseeeewneneeeenenweese
neeesweswwneeeeeneeeneesenee
swwwneseswswswwwswsewswswnw
eswenenwnwswnwwnwwnwsewnwneswnwneswnwne
nenwneneneesenenwnesenwwnenenenenwnww
wwenwswswwswwnwsenwwwseewwswwww
swwswwwswwnwnwswweswswwswswswwe
eeneeseneseeeesweeeesesw
nweesewnewneseneneneneneseeeneenene
enwweswwseseenwswweee
wwwnwnwnenwwnwswnwnwwwswwnwenwwnw
nwseneneneeneneeeeneewswswwne
nesesesesweseeseseseeesenwse
eseesenwnwswseneswseseeese
nwseswneswnewnwsene
eeeeeeweseseweeneeeeesee
nenesewnesenwewwwsewwwewwnesesew
wwnwswseswsenesewsenwseeee
seseseswseswnwseseneseseswsenewswswsesw
seenwenweeseseesweswesenewewee
swneenenenenenwnwnenwnenenwnwnenwnwne
sewwwwwwsenewsewnwenwswswnenwnwnw
seseseswsewseseseewnewsesenwnesenene
nwnwnesenweswswnweswnwnenenwnewnwnwwnwne
swenenwseswnewweswnenenwewnwnewnw
nenenenesenewenenenenwneneswnwneenwwne
nesewwnwnwswseenenwnwwewnesenwnwswsw
eeewenwseeeseesesweseenwnwee
nwwswnenwsenwwswneewwwwwnwwswnwsenw
nwnwwnenenewnenenenenwnwnenwneneseenene
nwswswswswswswswswswswswseswswseswesw
swswseseseeseseseseneesesesewsenwnwseswse
wswwnewwwswwswwewswwwseneswww
wwwwwwwswwew
ewewnwswnwwswnwwwwnwewwwnwwnwnw
nesenwneneeneneeneeneeeneneeewne
seseseseseswwsesesesesenese
seswsweneswseeswswwseswnewseswnwsw
swweneswneneeeneeeeneeeenw
wnwnenweswewnwwwwnwswsewnwnwnwwwnw
swseneeeneswseewwneseweesewwese
nwwnwwnwwnwnwwnwwnewwnwnwwnwsesese
senenwswseswseesesenesesesewwsesenesesese
nwnwnwnenwnenwnwewnwneswwnwenenwnwnw
nwenwnweseswwwnwnwnwnwnenenenwnwnwnwnw
nwneneneenenenwneswnenenenenwnenenene
swsweswwswneswswswswswwwsww
wwsewwwnewwwwswnewwwwwww
nenweeewswneneswneeeseesweseswewne
sesesweeeenweeeeenwswwnwwee
neeewwnewesewwwnesewwewseenww
enwwwswnwwenwwnwwwenwwswwww
newnwsenwwswwswnwsewnenenwnwneesenwsew
nenenewneeneneneeneneeswnenenwswnee
neenewsenenwneneneswsenenenenwneneswnw
eswneesesenwwseseeeseeewnesesesese
eeswnwnwnwnwnenewnwnwsenwnwnwnwnwnwnwnw
seswsesesweneseswswwswwseswswseseseswsw
swnwsesenwwnewnwwwwnwnwwenwneneswnwnw
wsenwseeseseseweneseeesese
nwsenwnwwnwewenwnwsw
seeswseneeneswsesewseswneseseseseeenw
nwswswswswseeswswneswseseseseswswseseswswne
swnwnwswenwsenwswewwneewwswwnwne
wnwwsenwenwswnwnwnwnwnwnwnwnwnwenene
wwnwswnwwnwwwnwwnwwnwnwwenwnwwse
nwneswenenwnenenenenenenwneswneswnwnwnene
neneenenwneneeeswnenewneeseneewene
ewwswsenwwnwsenwnwnwnwwwnwnwwnwwse
eeeeneseeeeeenweeweseeneee
nwnwnwnesenwnwwnwneswnwnwnwnw
seseseseewesenewneseseseneesweesesw
weswnesweswwnenwswseneswseneswwswwsw
nwneeswnenenwnewnenenwneswswneneesenwne
swnewweewswwswswwnwewwwswswnwsww
swswswsenwswswswswsweswswwseswswneswse
weeeseeeeewneeeeneeseseewse
newseneneneswnenwneneeseseewneewsee
neneenwnewnweseswwneeswnwnwswnenwnwnw
neesenweneenweenesesweswenweeew
eeseseneseeseseseeeewenwseeesee
weseseswswswswswswseseseseswse
eewswwseseseseseseeeseseenenw
swwnwsenwnewswnwswsweeswwwwswsenese
neneewneeeeeeseeneeeneeeenw
swseswsweswswswwswnwenwswswswswswnew
swswswswswswnesewswseseenwseswswswswswsesw
wnenesweesenweeswwnwseenwnesweswee
nenwnwnwswswnwnwsenwwnwnenwesesenwnewswe
swsenwesesewswenwwseneswswseneswne
nwnwnenwnwenenenenwswnwnwnw
eeneneneeswnweneeswswneeneeneeene
nwswswewwnwswwwswwenewseswwww
senwseseswwseesenesweswnwseseseeenwe
eweneeeeseneeeeee
wwwswwwwesewnewwww
nwnwnwnwnwnwswnwnwnwnwnwnwenwswnwnwneenwnw
eeeseenweeeeeeeseewnesesewe
swswewswswswswswswswseswenwseswswnesw
nweswenwnwesweseseseeeeee
nwenenenewswwsenenwnwnwnenenwnenw
nwneneneswneneneneseneneneneneneneneene
swswnwwswwwswsweswsweneswswswswwswsww
swswneenenwwnwwsewswenenewwseseswnw
nenenesweneeswneeeeneneswenenenenee
nenwseenwnwneswnenenweeneswnwnewsenesw
swwwswwsewwwswswnewwwwwswswne
weesesenwenwneswneeesweweneswnew
nwenenesenwneneneneswswnwwneswnwnwenwne
senwnwwnwnwnwwsenwnenwnwswseneww
senwseseseseseseneneseseswesenwswsesesesw
wenweneeseeseweeeweeneeeenee
seseswewneseseseesese
seeseeewseeeeseewe
eeswnweeeeneeeneeee
eneweeeeeeeenee
sweseswswswswswswswwswswseseswnwswsesw
nwwsewnewwenwnwnwswswnw
weseswsewseswnwswnwsesesenwneseswsenese
newnwneeenewsenwswnwnwnenwnewnenenw
nwsenwnwnwnwnwnwsenenenwnwnwnwwnenenewne
wneswnwwwwsewwsewwwwwwenwe
wwswswswnenewswwswewwsenwweww
enenesweeneneeneeseeneeneeewnwe
neneneneneswnenwnewenwnenenwneneenenwne
nwnweeeswneseseswnwsesweseeseenwewe
ewnwnwswnwnwnwwswnwnwnewnwneseewww
wenwwsenwswwnenwnwnwwenwwnwnwseww
enwswnwnwnwsenwnwswnwnwnwnenwnwnenwnwnw
nwnwenwwwnwnwnwwsenwnwnwnwnwnwnw
nwswswnwnwenenwnwnwnwnwenwnenenwnenwnenw
nwwswwswswneneswsewwseswwwsewswnesw
nwsewwwwwwswwnwenwwwwwwnew
nwnwnwnwnwnwneneswnenwnenwnwnwne
nenenenenesesenenenenenenenenwnwnenenenew
swswwewswwnenwnewwwsewsw
nwnwnwnenwsewsewnwnewwneswnwnw
swswswswswseswseseseneswwswseneseswsesw
nwnwnwnwnwnwenwnwnwwnwnwnwnwwwenwnwsw
eneeeeeeeeeenesenenenenewewne
eneewewwseewenwsweeneeeesene
sewseseswswswseswseseseneseswseneswsesesw
ewwnwwswswnwnesesewnweesweseeenene
wswnewsenwwwwwnwnwenwwwwwwwwnw
eeseeneeweneeeeeeweeeseee
wswswswswswswwswswswnwswewswwnwswewsw
wseseeesenwseseeeeenwsesesesw
eseesewnweeswneeeewese
sweswswswnwswswwswwnwswwewewnewsew
eeeneeeneeneenwenwsweneswneeenee
swenwseneweseneneneeewswewnwneeese
wwnwnwsweeeneswnewseswneswswneese
seswsesesenwseseseseswswesenwseseswsese
senenenenweeeneeneeweeneeeesw
seseseneswseseswwswseseneswswseneeswse
wwswwwenwswwwswseswww
sweswswseseswswnwswseswsw
eeeweeeneneweneweseeneee
seswwseseneneswswseswneeseswwswwsesw
nwenenewneswnewwnewnesenwenwnesenwne
nwnenwwnwnenwseswsenesenenenenwesenwne
neswswwswwswwsww
nwwsewwwsewenewwswwnewwwswwse
nwsenwnwsenenwnwnwnwnwnwnwnwnwnwwnwnwnwnw
nwsenwwnwnesenenenwnwnwnwnwnwenwnwnenene
seseseswnewseseswwneneseswe
neswwswswswswsweseswsesesesenwseswnwsese
eseesweeeneeseseseenwseneseseswse
wswwsewewwwwwwwwwswwwwnew
newnwwswnewwswwwwswswsesewwsweswsw
eeeneneneneneseneswnwneenenenenenwne
nwswnwenenenenenwnenenewnesenenwnwnwne
wsenwwwwewwnewwnwsewwswwnwww
neseseewneeesenweswneeesesewesese
nwnwnenenwnwnwnwnwnwnwnwnwnwnesenw
nwwwnwswnwwnwnwenwwnwwewwwwse
neseswswswseswswswswswsesw
sweeneneeenewnwswneeeneneeenee
nwswenwenwswnenenenwseesenwwswswese
eeeswseeeneneeewseesesweeeee
nenenwnesenwsenenenenwnwneseneneswnenese
enwnwnenwnenwnenenewnwswnwnenwnenwnwnesw
eeeeewseeenwsw
nesenenenwwenwnwnenwnwswnenesenwnwnenw
sewswneneswsewww
weswswswswswnwwswwewwwwswswwswsw
nwswnweswnenwnenwnwnwnwseene
enwenwnenesewneeeswnewseenenwnee
eeeeseenwneenenenenwnenweeeseswse
nwseswseswswnwswesenwesesene
wnwwnwwewnwnwnwwwwnewwswnewwnwse
eswseswswswwswswswswswswswnwsw
wwneswwwewnwswewwwswwwwsew
seseseseseswsewneswseseseneswseseswswnesese
nwneswswswsweswewswswswwseswswnwswswesw
neswnenenewswnwswsenwnwenwnenenenwnwnwswne
swnwneseneeeneneeeeneneneswneene
eseeeenweeeeesweese
seseeseseseseseseswwseseseneesesesese
eseseeseenwseseseenweseeseenwesee
nwswneneneneneneeneneeneeneesenenwse
nesewnenenenenenewnenenenenenenenesene
nenwnwwsenwwnwswsewnwnwseeswenwwnww
swseswswsenwseseswsweseswswswsw
neswswnwnwneswnwswnweneswnwweenwnwswne
swswsweswswswswwswnwswwwswwswseeswnw
nwnwnwnwnwswnwwnwnwnwenwnwnwsesenenwnw
nwseneseswseseswswnwseseswenewswsesese
neneeeswnenwneneeseswneneeneswwnene
seneswswswswswnwseneseseswswswseesewsee
neesenenenweeesweenwww
wseswwswewswwwswwwswwwwwnwnewsw
swnwswneswswswswswseswswswseseswsweswsw
seswseswswswsesweseswwenwswsesw
sewseseseseseeseseenewsesesesesesesene
sewsesesesesenesenesewseseseeswsesesese
enenenenenenenenenenenenenewnenesene
sewwnesewwwnweneeewnwwww
enwswewswwnwnwnwnwwnwswwnwnwenwnwenw
wwwweeswnwwsenwsenwnwwswnwenwwnw
nwnwneneeneseenenwwneswnenwwswnenwneenw
nwnwwwnwswnwwnwwweneswew
wnwnwwwsesenwnwwwnwnwnwwnwnwnenwnwne
seswswwsewswneswswnwswsenwneswseswswesw
nwnwnwnenesweswnwnwnenenenenwnwneeswnwnw
newnwsewsewwswswwswwswneewwnew
wwwnwwnwwwsenwwnwwwwewnwwew
seneneswwnewsenwswnesesewnenwsee
wnwnwnenwnenwswnwnwnenweswnwnwnwsenwne
nesenwswneseswnwneswswswsewse
nenenwneseneneeeswnw
eeeweeeeesenweeesenw
wswsenwnweeeswnesenwsesenwwswesww
nenenwsewneswnwnwneenewnenwenenenwne
eeeseeeseeseeeewewseeeee
neeseewseeeeewneeeeeeesenwesw
swewseeneswswswswwnwswswwswswswwnw
swswswswswnwenenewswswseswswswnesw
wneswseneneneenenewnenenene
nwnwswswnwenenwnene
eeeeswneneswwsenweneseeenweene
seseneswswnweswswsenesesew
eesenwnweseeeseeseeeeeseseese
wwwsewnwewwwswswwswwwwwswneww
neseeneneesesesesweeesesewsewsee
nwnwnenwwwnwesenwwnwnwwnwwnwwwnwnw
newseseswseswwesesese
sweenwnewsenwnwwwwwwswe
wnwswneswnewnwwnewnwwwwwwswww
eeeseseseseeeseneeeswweenwnwse
neswswswswnenwswswswwswswswswswseswsww
eeeneseeswneenewnweseeneeeneene
enesenwsesesewseseseseweseseseseseee
wswseenwwnwwnwnwnwwnewenwwwwnw
wnwwwwsewswwswenwwwswwwwsww
nwnwnwnwnwnwnenwnwnwwsenwwsenwnwnwnwnw
seseeswswnwswsenwnesw
swsesesesewseseneswswseeseswsewsesesw
nenewwswewswwnwwsesweswwwswwwsenw
swswswswswseswseseseseswsenweneseswsesesw
wswnewwwwwwnwneseswnewswsewwww
wswnwsweseneseseesesesesesesesesesww
neneneneewneswnenenenenenenenenenenese
wnwnwnwnwneneesenwnwewnwnewsenwnwnw
neneneeneseswenenwneneeenweneene
neeneneneswneneeeswneenenwneeneene
nwnenwnwnwnwnwnwnwsenwnwnwnwnwneswnwnwnese
swwenwnwnwnwswwnwnwnenwnwnwenwweww
wweneeneeneneneneneenene
enwseeswesenwseswee
sewnwswwwsenenenweswswnwnweeeeee
swenwsenenwnwnwwwnwwnwnweenwnwwnwnw
newseneswnwwwwswwwwwwewnwswnw
wwsenwsweesweseeenewsenwnwseee
neneswenwnwneneneneneneneneneneswneswne
seweeesenweeseneesweeeeseseee
nwwwnwwwnwnewwwswwnwsewnwwwwew
nwnenwsenwnwnwnwnwnwwnwnwenwnwnwnwswnwnw
neneweswnenenenene
eeeeseeewenweeeeeneneeee
senenenweswneneneswnee
swnenwswnwnwsenwwnwnwwnwwwwnwewnwenw
eswnwnenenwnenenenwnenwneswnwnenenw
nesenwnwnwnenenenenewwnenwsenenenwswne
wweseswwwenenewnwseeeswenewnwsw
swsesweeeseswnesewnwenwseseneenenwesw
swwswesenwsweswswswswseswseswwswswneswse
ewwnwnwswwwwsenwwnwnwwwnwnewseww
nwnwswswseneswseseseswseewswwseseneswse
newswsweswswneseswswswswswswnenwseswsesew
ewseenwswnwwnwnenwnwneneneeswswenene
seseswswwseseseswswswseswneswswneseswsese
wswesewwwwnewwnwnwesewnwwsesw
nesesesweseeseeeseswesenwenwewse
neneneswnwnenwwsenenenwnwnenwsenwenee
eeeweeeeeeeeweneeeewese
nenwnwwnwwwnwnwwsesewwnwnwnwnwwnww
seseeseesweesesesenweesenweesese
eweenwseeeeeeeeweeeewe
nwneewneneneneneswnewnenenenenenwenene
swswneswwswwwnwwseneseswwsw
neneenwewnwswesesene
seseseswswnwswseswsesesesesewneeswnwse
wswnewnwwnwnwwnwwwwwnwwewswnew
wnenwnwnenenenwneenwnenenenenenesewnesw
nweswenenwwnenwnenenwneseswnenww
swwnwnwswnwseneswsesesweseswneee
seewnwwneseneswseswewnwnwnewwnwwnw
enwseseeenweeseseseee
seswseswseswnenwsenwseswswseswwseseswswsw
seesesesesesesesewsesenenwseseseneesesw
eeeseenwseeeseesewesesesenesese
swsweswswswswswswweswswswswnwseswswswsw
wwnwsweswswwnewwswwswswseswswwww
swswswseneewwswnwwwseeswnwnwswnwswse
ewseeeeeenweeeeeeseeesese
ewwwwswsewwnwswnwwwswwwsenesww
wwswswwnwwwwswwwswewswwwswse
esenwsesesewsesesenweswseseswseeesee
nwnenenenwswnwnwewneseneenenenenenenene
esesesenwwseseseeseenweseseswswe
wwnwwsewwwwwswnwseewwnwww
seneneseenenwwewneneneenewneeneee
nwneenenenwnwneswswnwnenwwneenwnwsene
seseeeweseseseseeneweeeseeesese
nwwnwnwnwnwnwenwnwenwnwwnwswwwsenw
swnwnwenwnwnwnwnwnwsenwnenw
swwseswswswswnenwswswswswswswswswswswsw
newwwnwsewewnwnwsewwnwnwww
eeeeeseenweeeeeene
swwnwnwsenwwnwnwwewewwswnwseew
ewnwnwnenwsesenwnwwswwnewwnwwnewsw
eseswnesewsesenweneseenwweseseese
nwnenwnwswwnwenwwswwwnwnwnwwnwwne
neneeeeeeenweswnee
nwnweswnwswnewswnwsenwweswenenwesw
neenewneewenenenwsee
nenwnenwwnwnenwenwnenwnwnenwnwnesenesew
swswswswnwswswwswswseneswswwswswswswsw
newseeswwseeneeeeeneneneneneswwe
neneneneneswneeewenwwsewnenwnwswswne
eneeneeneneeneeseeeewnesweene
nwnwneswwseswswswneeweenesewnwseswswsw
nwseseswnwseenwsenwwsenwnwnwnwenwwnenew
enenwwswsewwwneeswnewswsewnew
nenwnwnwnwenweswsenwenwnwswnwswswse
eenwwnesesenesesesewsesesewsesew
nwwnwsenwneseneneswneneneswenwsw
nenwnenesenwnenenwnwnwsenesenenenwnenenwnw
seeeewswnwewseneewne
wswwswsweswswswsweswsw
enesenwseseswesenwsenenwswenwsweswsesw
eeswnenwnenenenenwneneweseswne
wwnewwwwwnwewsewwwwwwew
newseseneswnwnwnenwneneweseseewnesw
seeewsenesesweseweeseenwnwesene
nwnwnenenwnwnwnwsenenwnesenenenwnenwnwne
nwwnweswwwwnwenwwnwnwwwweswe
wsewwwwwnwwwsewsenenewwwwwswsw
swneneeneeneswnesewnenewseenesewe
nenwswswswswswswswswswseswwswswswswsw
seseewesweseseeseenweeseseseesenwsw
esewneseseneseseswseswwswseswseseswsese
nwnwnwnwneeweswnenenenwnwenwswseew
wnwenwneenwwnwnwwnwenwsenwwnwnwnw
swswneswswswseswswneswswwswnwswswwew
nwnenesweneeeeneeswnweeeeene
nwswswwswswseseneswswwnewsweswswswsw
wswwwwwewwwe
nenenenesewnenenenenwnenenenwwswnwsene
eeseseenweeeesweeeeewee
wswnwneswnwwsewwswswswwweswseswswew
wsesesewenwswseswseweeswswesesw
senwswseswswseswswnwswnwnesweweenesewse
weneneneeneneswneeeenenwneswswnee
nwnwnwnenwnwenwnenenwwnwsewsewenenwnw
nenenenenewneneneneneneneneneene
eswseswwwwwwwnwswsewweswnewe
wseweenweeneewseeseswesese
wnewenwsweeneenesenesweneeneee
nwnwwnwnwwwnwnwsenwwnewwenwsenww
swneseswswswsenwwenwswwwswswneswwwnew
esenwenwswwswenwswsewnwswswswenw
swnwewneeswswswswswswswnwseseseseesesw
nenewnwnenesenenenesweneneeneneneneenene
neswsewnewswswswwseswswneswwswseswswsw
nwswwnwnwenwnwnwnwnwnwnwnwwnwwnwnw
seseneswnwneswsesenwswnewnwnwsenwewnenene
neneeesesenwneneeeneneeswneeenww
eeesweeswseeseweeeneseeeeenw
seseseeeswwswwneswswwnwnwseeswese
swnwnwenwnenenwnwneenenwnenwnwnenenwswsene
wwsenewnwwnwwwwwwwsenwswnwwww
enenewnwswseeneseewneseseswesesee
nwwwswsewwnwwnwwwwswswswseswswe
wseswwseswnwseeseseeseseseseeswne
enwsesweeeeeneeeeeeeeeenw
seseeseseseeseswsesenwweeseenesenwsesw
senwneseseseswseswseswseswnwsesesewsesesese`;

function partOne() {
    const instructions = input.split("\n");

    // the center tile is x0y0, n/e is positive, s/w is negative
    // moving e/w changes x by 1
    // moving n/s changes y by 1 and depending on the e/w direction x by 0.5
    let floor = [];
    for (let i = 0; i < instructions.length; i++) {
        let lineIndex = 0;
        let [lineX, lineY] = [0, 0];
        while (lineIndex < instructions[i].length) {
            let currentLine = instructions[i].slice(lineIndex);
            if (currentLine.startsWith("e")) {
                lineIndex++;
                lineX += 1;
            } else if (currentLine.startsWith("w")) {
                lineIndex++;
                lineX -= 1;
            } else if (currentLine.startsWith("se")) {
                lineIndex += 2;
                [lineX, lineY] = [lineX + 0.5, lineY - 1];
            } else if (currentLine.startsWith("sw")) {
                lineIndex += 2;
                [lineX, lineY] = [lineX - 0.5, lineY - 1];
            } else if (currentLine.startsWith("ne")) {
                lineIndex += 2;
                [lineX, lineY] = [lineX + 0.5, lineY + 1];
            } else if (currentLine.startsWith("nw")) {
                lineIndex += 2;
                [lineX, lineY] = [lineX - 0.5, lineY + 1];
            }
        }
        const tilePos = `x${lineX}y${lineY}`;
        if (typeof floor[tilePos] == "undefined") {
            floor[tilePos] = "black";
        } else {
            floor[tilePos] = (floor[tilePos] == "black" ? "white" : "black");
        }
    }

    return Object.values(floor).filter(item => item == "black").length;
}

function partTwo() {
    const instructions = input.split("\n");

    // DAY 0: initial state based on instructions
    // the center tile is x0y0, n/e is positive, s/w is negative
    // moving e/w changes x by 1
    // moving n/s changes y by 1 and depending on the e/w direction x by 0.5
    let floor = {};
    let [xMin, xMax, yMin, yMax] = [0, 0, 0, 0];
    for (let i = 0; i < instructions.length; i++) {
        let lineIndex = 0;
        let [lineX, lineY] = [0, 0];
        while (lineIndex < instructions[i].length) {
            let currentLine = instructions[i].slice(lineIndex);
            if (currentLine.startsWith("e")) {
                lineIndex++;
                lineX += 1;
            } else if (currentLine.startsWith("w")) {
                lineIndex++;
                lineX -= 1;
            } else if (currentLine.startsWith("se")) {
                lineIndex += 2;
                [lineX, lineY] = [lineX + 0.5, lineY - 1];
            } else if (currentLine.startsWith("sw")) {
                lineIndex += 2;
                [lineX, lineY] = [lineX - 0.5, lineY - 1];
            } else if (currentLine.startsWith("ne")) {
                lineIndex += 2;
                [lineX, lineY] = [lineX + 0.5, lineY + 1];
            } else if (currentLine.startsWith("nw")) {
                lineIndex += 2;
                [lineX, lineY] = [lineX - 0.5, lineY + 1];
            }
        }
        if (lineX < xMin) xMin = lineX;
        if (lineX > xMax) xMax = lineX;
        if (lineY < yMin) yMin = lineY;
        if (lineY > yMax) yMax = lineY;
        const tilePos = `x${lineX}y${lineY}`;
        if (typeof floor[tilePos] == "undefined") {
            floor[tilePos] = "black";
        } else {
            floor[tilePos] = (floor[tilePos] == "black" ? "white" : "black");
        }
    }

    // DAY 1-100: flip tiles if necessary based on other tiles
    const modulo = (n, m) => ((n % m) + m) % m; // because % isn't modulo but the remainder so negative returns negative https://stackoverflow.com/a/17323608/4214819
    for (let j = 0; j < 100; j++) {
        let todaysFloor = { ...floor };
        for (let checkX = Math.floor(xMin) - 1; checkX <= Math.ceil(xMax) + 1; checkX++) {
            for (let checkY = yMin - 1; checkY <= yMax + 1; checkY++) {
                let [tryX, tryY] = [checkX, checkY];
                if (modulo(tryY, 2) != 0) tryX -= 0.5; // offset tiles by 0.5 for odd rows (because of floor/ceil -/+ 1, this still should be 1 tile around current min/max)
                const thisTileColor = (typeof floor[`x${tryX}y${tryY}`] == "undefined" ? "white" : floor[`x${tryX}y${tryY}`]);
                const tileState = [
                    (typeof floor[`x${tryX + 1}y${tryY}`] == "undefined" ? "white" : floor[`x${tryX + 1}y${tryY}`]), // E
                    (typeof floor[`x${tryX - 1}y${tryY}`] == "undefined" ? "white" : floor[`x${tryX - 1}y${tryY}`]), // W
                    (typeof floor[`x${tryX + 0.5}y${tryY - 1}`] == "undefined" ? "white" : floor[`x${tryX + 0.5}y${tryY - 1}`]), // SE
                    (typeof floor[`x${tryX - 0.5}y${tryY - 1}`] == "undefined" ? "white" : floor[`x${tryX - 0.5}y${tryY - 1}`]), // SW
                    (typeof floor[`x${tryX + 0.5}y${tryY + 1}`] == "undefined" ? "white" : floor[`x${tryX + 0.5}y${tryY + 1}`]), // NE
                    (typeof floor[`x${tryX - 0.5}y${tryY + 1}`] == "undefined" ? "white" : floor[`x${tryX - 0.5}y${tryY + 1}`]) // NW
                ];
                const blackTilesAround = tileState.filter(item => item == "black").length;
                if (thisTileColor == "black" && (blackTilesAround == 0 || blackTilesAround > 2)) {
                    if (floor[`x${tryX}y${tryY}`] != "undefined") todaysFloor[`x${tryX}y${tryY}`] = "white"; // else already white/default so ignore
                } else if (thisTileColor == "white" && blackTilesAround == 2) {
                    todaysFloor[`x${tryX}y${tryY}`] = "black";
                    if (tryX < xMin) xMin = tryX;
                    if (tryX > xMax) xMax = tryX;
                    if (tryY < yMin) yMin = tryY;
                    if (tryY > yMax) yMax = tryY;
                }
            }
        }
        floor = { ...todaysFloor };
    }

    return Object.values(floor).filter(item => item == "black").length;
}

console.log(partOne());
console.log(partTwo());